import pytest
from day9.day9 import day9_part1_algorithm, day9_part2_algorithm, is_inside, get_edge_tile_locations, is_vector_inside


def test_day9_part1_full():
    test_input = """7,1
11,1
11,7
9,7
9,5
2,5
2,3
7,3""".replace("\r", "")
    expected_output = 50
    assert day9_part1_algorithm(test_input) == expected_output


@pytest.mark.parametrize("red_tile_locations, expected_result", [
    ([[1,1], [1,3], [4,3], [4,1]], {(1,1),(1,2),(1,3),(2,3),(3,3),(4,3),(4,2),(4,1),(3,1),(2,1)})
])
def test_get_edge_tile_locations(red_tile_locations, expected_result):
    assert get_edge_tile_locations(red_tile_locations) == expected_result


@pytest.mark.parametrize("edge_tile_locations, vertical_edge_vectors, point, expected_result", [
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (2, 3), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (1, 1), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (1, 4), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (4, 1), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (4, 4), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (3, 4), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (3, 1), True),
    ({(1,1),(1,2),(1,3),(1,4),(2,4),(3,4),(4,4),(4,3),(4,2),(4,1),(3,1),(2,1)}, [([1, 1], 3), ([4, 4], -3)], (1, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (3, 1), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (1, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (2, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (3, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (4, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (5, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (6, 3), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (7, 3), False),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (1, 4), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (2, 4), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (3, 4), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (4, 4), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (5, 4), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (6, 4), True),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (7, 4), False),
    ({(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(6,2),(6,3),(6,4),(5,4),(4,4),(3,4),(3,3),(2,3),(2,4),(1,4),(1,3),(1,2)}, [([6, 1], 3), ([3, 4], -1), ([2, 3], 1), ([1,4], -3)], (7, 1), False),
])
def test_is_inside(edge_tile_locations, vertical_edge_vectors, point, expected_result):
    assert is_inside(edge_tile_locations, vertical_edge_vectors, point) == expected_result


@pytest.mark.parametrize("edge_vectors, p1, p2, expected_result", [
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (2,2), (4,2), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (1,2), (4,2), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (0,2), (4,2), False),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (2,2), (5,2), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (2,2), (6,2), False),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (2,1), (4,1), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (1,6), (2,6), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (1,6), (2,6), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (1,6), (3,6), False),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (1,6), (4,6), False),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (2,6), (4,6), False),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (3,6), (4,6), True),
    ([([1,1], [4, 0]), ([5,1], [0,8]), ([5,9], [-2, 0]), ([3,9], [0,-5]), ([3,4], [-1,0]), ([2,4],[0,5]), ([2,9],[-1,0]), ([1,9],[0,-8])], (3,6), (5,6), True),
])
def test_is_vector_inside(edge_vectors, p1, p2, expected_result):
    assert is_vector_inside(edge_vectors, p1, p2) == expected_result

def test_day9_part2_full():
    test_input = """7,1
11,1
11,7
9,7
9,5
2,5
2,3
7,3""".replace("\r", "")
    expected_output = 24
    assert day9_part2_algorithm(test_input) == expected_output
